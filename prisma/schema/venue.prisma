model Venue {
  id String @id @default(uuid())

  name          String
  googlePlaceId String? @unique // Google Places API place_id for deduplication
  catgegory     String
  subcategory   String

  location  String
  latitude  Float
  longitude Float

  description String?

  imageId  String?       @unique
  imageUrl String?
  image    FileInstance? @relation(fields: [imageId], references: [id], onDelete: SetNull)

  votes          Votes[]
  operatingHours OperatingHours[]

  source VenueSource @default(database)

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt

  @@map("venues")
}

model OperatingHours {
  id String @id @default(uuid())

  venueId String
  venue   Venue  @relation(fields: [venueId], references: [id], onDelete: Cascade)

  day       Int // 0 (Sun) to 6 (Sat)
  startTime String? // "HH:mm" or "HHmm"
  endTime   String? // "HH:mm" or "HHmm"

  @@unique([venueId, day])
  @@map("operating_hours")
}

enum VenueSource {
  google
  database
}

model Votes {
  id String @id @default(uuid())

  userId String
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  venueId String
  venue   Venue  @relation(fields: [venueId], references: [id], onDelete: Cascade)

  isOpen Boolean

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt

  @@index([venueId, createdAt(sort: Desc)])
  @@index([userId, venueId, createdAt(sort: Desc)])
  @@map("votes")
}
